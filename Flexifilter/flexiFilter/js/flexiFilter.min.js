(function(a){a.fn.flexiFilter=function(b){a.extend({source:"",resultHandler:function(){console.log("data fetched, but no callback provided. Please provide one by passing a function as the resultHandler param in the flexiFilter plugin invocation")},enhanceUI:!0},b);this.each(function(){var g=this;a.getJSON(b.source,function(d){a("#sourceJSONContent").html(JSON.stringify(d,void 0,4));for(var h='<form class="flexiFilterForm" id="flexiFilter_'+d.searchName+'" action="'+d.searchEndpoint+'"><div class="flexiFilter">',
f=0;f<d.searchCriteraSections.length;f++){for(var h=h+('<h3><a href="#">'+d.searchCriteraSections[f].sectionName+' <button class="flexiFilterToolTip" content="'+d.searchCriteraSections[f].sectionHelpText+'" onclick="alert(\''+d.searchCriteraSections[f].sectionHelpText+"'); return false;\"> What's This</button></a></h3><div>"),e=0;e<d.searchCriteraSections[f].searchCriteria.length;e++)for(var i in d.searchCriteraSections[f].searchCriteria[e])if("criteriaType"==i)try{h+=window["flexiFilterDraw_"+d.searchCriteraSections[f].searchCriteria[e][i]](d.searchCriteraSections[f].searchCriteria[e])}catch(c){console.log("unable to call handler function for criteria type "+
i+". Please check to make sure type is supported. Default supported types are: text, dropmenu, slider, checkbox, and radio"),console.log(c)}h+='<div class="spacer"></div></div>'}a(g).html(h+'</div><div class="ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom ui-corner-top"><button id="submitForm" onclick="return false;">Search</button><div class="flexiFilterLoader"></div></div></form><div id="flexiFilterDialog" title="Alert!">Default content</div>');a(".flexiFilterForm div [criteriatype=slider]").each(function(){a(this).slider({min:a(this).attr("minValue"),
max:a(this).attr("maxValue"),slide:function(b,c){a("#flexiFilterSliderValue_"+a(this).attr("criteriaName")).html(c.value)}})});b.enhanceUI&&flexiFilter_enhanceUI();a(".flexiFilterForm #submitForm").click(function(){a(".flexiFilterLoader").show();var c=a(this).parent().parent().attr("action"),i=a(this).parent().parent().serializeObject();a(".flexiFilterSliderValue").each(function(){i[a(this).attr("name")]=a("#flexiFilterSlider_"+a(this).attr("name")).slider("value")});var e=JSON.stringify(i);a("#sentSearchJson").html(JSON.stringify(i,
void 0,4));a.getJSON(c,e,function(c){a("#returnSearchJson").html(JSON.stringify(c,void 0,4));"function"==typeof b.resultHandler&&b.resultHandler(c);a(".flexiFilterLoader").hide()}).error(function(){alert("Error requesting page "+c+". Please ensure url is on the server and that it result contains valid JSON");a(".flexiFilterLoader").hide()});return!1})}).error(function(){alert("Error requesting page "+b.source+". Please ensure url is on the server and that it result contains valid JSON")})});return"ran!"}})(jQuery);
function flexiFilterDraw_text(a){return'<input type="text" name="'+a.criteriaName+'" id="flexiFilter_'+a.criteriaName+'" '+flexiFilter_parseAttributeList(a)+' value="'+a.criteriaLabel+'" /><div class="clear" />'}
function flexiFilterDraw_dropmenu(a){html='<select name="'+a.criteriaName+'" id="flexiFilter_'+a.criteriaName+'" '+flexiFilter_parseAttributeList(a)+">";for(var b=0;b<a.criteriaValues.length;b++)html+='<option value="'+a.criteriaValues[b].id+'" '+flexiFilter_parseAttributeList(a.criteriaValues[b])+">"+a.criteriaValues[b].label+"</option>";return html+="</select>"}
function flexiFilterDraw_checkbox(a){return'<input name="'+a.criteriaName+'" type="checkbox" id="flexiFilter_'+a.criteriaName+'" '+flexiFilter_parseAttributeList(a)+'><label for="flexiFilter_'+a.criteriaName+'">'+a.criteriaLabel+"</label>"}
function flexiFilterDraw_slider(a){var b='<div class="flexiFilterSlider"><div class="flexiFilterSliderTitle" id="flexiFilterSliderTitle_'+a.criteriaName+'">'+a.criteriaLabel+'</div> <div class="flexiFilterSliderValue" name="'+a.criteriaName+'" id="flexiFilterSliderValue_'+a.criteriaName+'">0</div>';return b+='<div class="clear"></div><div id="flexiFilterSlider_'+a.criteriaName+'" '+flexiFilter_parseAttributeList(a)+'></div></div><div class="clear"></div>'}
function flexiFilterDraw_radio(a){for(var b='<div class="flexiFilterRadioGroup">',g=0;g<a.criteriaValues.length;g++)b+='<input type="radio" name="'+a.criteriaName+'" id="flexiFilterRadio_'+a.criteriaName+"_"+a.criteriaValues[g].id+'" value="'+a.criteriaValues[g].id+'" '+flexiFilter_parseAttributeList(a.criteriaValues[g])+'><label for="flexiFilterRadio_'+a.criteriaName+"_"+a.criteriaValues[g].id+'">'+a.criteriaValues[g].label+"</label>";return b+"</div>"}
function flexiFilter_parseAttributeList(a){var b="";a["class"]=a.hasOwnProperty("class")?a["class"]+" flexiFilter":"flexiFilter";for(attrib in a)"string"==typeof a[attrib]&&("id"!=attrib.toLowerCase()&&"type"!=attrib.toLowerCase()&&"name"!=attrib.toLowerCase())&&(b+=attrib+'= "'+a[attrib].replace(/[^a-zA-Z 0-9]/g,"")+'" ');return b}
function flexiFilter_tableFromObjectArray(a){html='<table class="searchResultTable"><thead>';for(col in a[0])html+="<th>"+col+"</td>";html+="</thead><tbody>";for(var b=0;b<a.length;b++){html+="<tr>";for(col in a[b])html+="<td>"+a[b][col]+"</td>";html+="</tr>"}return html+="</tbody><table>"}
$.fn.serializeObject=function(){var a={},b=this.serializeArray();$.each(b,function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""});return a};(function(a){a.fn.flexiResultTable=function(b){a.extend({data:{}},b);this.each(function(){a(this).html(flexiFilter_tableFromObjectArray(b.data.searchResults))})}})(jQuery);
function flexiFilter_enhanceUI(){$(".flexiFilterForm .flexiFilter").accordion({autoHeight:!1,clearStyle:!0});$(".flexiFilterForm button").button();$(".flexiFilterForm input:checkbox").button();$(".flexiFilterRadioGroup").buttonset();$(".flexiFilterForm select").combobox();$("button.flexiFilterToolTip").button({icons:{primary:"ui-icon-info"},text:!1,label:""});$("button.flexiFilterToolTip").attr("onclick",null);$("button.flexiFilterToolTip").click(function(){$("#flexiFilterDialog").dialog("option",
"title","Info");$("#flexiFilterDialog").html($(this).attr("content"));$("#flexiFilterDialog").dialog("open");return!1});$(".flexiFilterForm input:text").button().addClass("flexiFilterTextbox").focus(function(){$(this).val()==$(this).attr("criterialabel")&&$(this).val(null)}).blur(function(){0==$(this).val().length&&$(this).val($(this).attr("criterialabel"))});$(".flexiSelectList").removeClass("ui-button-disabled ui-state-disabled");$(".flexiFilterForm input[type=checkbox]").button({icons:{primary:"ui-icon-circle-close"}});
$(".flexiFilterForm input[type=checkbox]").click(function(){$(this).is(":checked")?$(this).next().children(".ui-button-icon-primary").addClass("ui-icon-circle-check").removeClass("ui-icon-circle-close"):$(this).next().children(".ui-button-icon-primary").addClass("ui-icon-circle-close").removeClass("ui-icon-circle-check")});$(".flexiFilterForm input[type=radio]").button({icons:{primary:"ui-icon-circle-close"}});$(".flexiFilterForm input[type=radio]").click(function(){$(this).is(":checked")&&$(this).next().children(".ui-button-icon-primary").addClass("ui-icon-circle-check").removeClass("ui-icon-circle-close");
$('.flexiFilterForm input[type=radio][id!="'+$(this).attr("id")+'"]').each(function(){$(this).next().children(".ui-button-icon-primary").addClass("ui-icon-circle-close").removeClass("ui-icon-circle-check")})});$("#flexiFilterDialog").dialog({autoOpen:!1})}
(function(a){a.widget("ui.combobox",{_create:function(){var b=this,g=this.element.hide(),d=g.children(":selected"),d=d.val()?d.text():"",h=/^[^a-zA-Z0-9]*([a-zA-Z0-9])/i,f=g.children("option").map(function(){if(this.value){var i=a(this).text();return{label:b.options.label?b.options.label(this):i,value:i,option:this}}}),e=this.input=a("<input type='text' class='flexiSelectList' disabled='disabled' />").insertAfter(g).val(d).keydown(function(b){var c=a.ui.keyCode;switch(b.keyCode){case c.PAGE_UP:case c.PAGE_DOWN:case c.UP:case c.DOWN:case c.ENTER:case c.NUMPAD_ENTER:case c.TAB:case c.ESCAPE:break;
default:b.stopImmediatePropagation();if(91>b.keyCode&&59<b.keyCode||58>b.keyCode&&47<b.keyCode){var d=String.fromCharCode(b.keyCode).toLowerCase(),c=e.val(),f,j=g.children().filter(function(){var a=h.exec(this.text);return a&&2==a.length&&a[1].toLowerCase()==d});if(!j.length)return!1;c.length&&(c=h.exec(c))&&(2==c.length&&c[1].toLowerCase()==d)&&j.each(function(a,b){if(b.selected)return a+1<=j.length-1&&(f=j[a+1]),!1});f||(f=j[0]);f.selected=!0;e.val(f.text);e.autocomplete("widget").is(":visible")&&
e.data("autocomplete").widget().children("li").each(function(){var c=a(this);if(c.data("item.autocomplete").option==f){e.data("autocomplete").menu.activate(b,c);return false}})}return!1}}).autocomplete({delay:0,minLength:0,source:function(a,b){b(f)},select:function(a,c){c.item.option.selected=!0;b._trigger("selected",a,{item:c.item.option})},change:function(b,c){if(!c.item){var d=RegExp("^"+a.ui.autocomplete.escapeRegex(a(this).val())+"$","i"),f=!1;g.children("option").each(function(){if(a(this).text().match(d))return this.selected=
f=!0,!1});if(!f)return a(this).val(""),g.val(""),e.data("autocomplete").term="",!1}}}).addClass("ui-widget ui-widget-content ui-corner-left").click(function(){b.button.click()}).bind("autocompleteopen",function(b){var c=g.children(":selected")[0];e.data("autocomplete").widget().children("li").each(function(){var d=a(this);if(d.data("item.autocomplete").option==c)return e.data("autocomplete").menu.activate(b,d),!1})});e.data("autocomplete")._renderItem=function(b,c){return a("<li></li>").data("item.autocomplete",
c).append("<a href='#'>"+c.label+"</a>").appendTo(b)};this.button=a("<button type='button'>&nbsp;</button>").attr("tabIndex",-1).attr("title","Show All Items").insertAfter(e).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("ui-corner-right ui-button-icon").click(function(){e.autocomplete("widget").is(":visible")?e.autocomplete("close"):(e.autocomplete("search",""),e.focus())})},setValue:function(b){var g=this.input;a("option",this.element).each(function(){if(a(this).val()==
b)return this.selected=!0,g.val(this.text),!1})},destroy:function(){this.input.remove();this.button.remove();this.element.show();a.Widget.prototype.destroy.call(this)}})})(jQuery);